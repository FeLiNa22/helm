## @section Frigate parameters

## @param enabled Whether to enable Frigate.
## @param replicaCount The number of replicas to deploy.
## @param image.repository The Docker repository to pull the image from.
## @param image.tag The image tag to use.
## @param image.pullPolicy The logic of image pulling.
## @param image.autoupdate.enabled Enable automatic image updates via ArgoCD Image Updater.
## @param image.autoupdate.strategy Strategy for image updates (semver, latest, newest-build, name, alphabetical, digest).
## @param image.autoupdate.allowTags Match function for allowed tags (e.g., "regexp:^[0-9]+\\.[0-9]+\\.[0-9]+$" or "any").
## @param image.autoupdate.ignoreTags List of glob patterns to ignore specific tags.
## @param image.autoupdate.pullSecret Reference to secret for private registry authentication.
## @param image.autoupdate.platforms List of target platforms (e.g., ["linux/amd64", "linux/arm64"]).
## @param imagePullSecrets The image pull secrets to use.
## @param deployment.strategy.type The deployment strategy to use.
## @param serviceAccount.create Whether to create a service account.
## @param serviceAccount.annotations Additional annotations to add to the service account.
## @param serviceAccount.name The name of the service account to use. If not set and create is true, a new service account will be created with a generated name.
## @param podAnnotations Additional annotations to add to the pod.
## @param podSecurityContext The security context to use for the pod.
## @param securityContext.privileged Whether to run the container in privileged mode.
## @param initContainers Additional init containers to add to the pod.
## @param service.type The type of service to create.
## @param service.port The port on which the service will run.
## @param service.nodePort The nodePort to use for the service. Only used if service.type is NodePort.
## @param ingress.enabled Whether to create an ingress for the service.
## @param ingress.className The ingress class name to use.
## @param ingress.annotations Additional annotations to add to the ingress.
## @param ingress.hosts[0].host The host to use for the ingress.
## @param ingress.hosts[0].paths[0].path The path to use for the ingress.
## @param ingress.hosts[0].paths[0].pathType The path type to use for the ingress.
## @param ingress.tls The TLS configuration for the ingress.
## @param resources The resources to use for the pod.
## @param autoscaling.enabled Whether to enable autoscaling.
## @param autoscaling.minReplicas The minimum number of replicas to scale to.
## @param autoscaling.maxReplicas The maximum number of replicas to scale to.
## @param autoscaling.targetCPUUtilizationPercentage The target CPU utilization percentage to use for autoscaling.
## @param autoscaling.targetMemoryUtilizationPercentage The target memory utilization percentage to use for autoscaling.
## @param nodeSelector The node selector to use for the pod.
## @param tolerations The tolerations to use for the pod.
## @param affinity The affinity to use for the pod.
## @param env.TZ The timezone to use for the pod.
## @param postgres.mode The mode of PostgreSQL deployment (only 'cluster' is supported for Frigate).
## @param postgres.initSQL Array of SQL commands to run on database initialization.
## @param postgres.username Username for the database.
## @param postgres.database Database name for PostgreSQL.
## @param postgres.password.secretName Existing secret name for database password (mutually exclusive with value).
## @param postgres.password.value Direct password value to create a secret (mutually exclusive with secretName).
## @param postgres.cluster.instances Number of PostgreSQL instances (replicas).
## @param postgres.cluster.persistence.enabled Enable persistence for cluster PostgreSQL.
## @param postgres.cluster.persistence.size Size of the persistence volume.
## @param postgres.cluster.persistence.storageClass Storage class for persistence.
## @param postgres.cluster.image.repository PostgreSQL container image repository.
## @param postgres.cluster.persistence.enabled Enable persistence for cluster PostgreSQL.
## @param postgres.cluster.persistence.size Size of the persistence volume.
## @param postgres.cluster.persistence.storageClass Storage class for persistence.
## @param postgres.cluster.image.tag PostgreSQL container image tag.
## @param tmpfs.enabled Whether to enable tmpfs cache for Frigate.
## @param tmpfs.size The size of the tmpfs cache for Frigate.
## @param persistence.config.enabled Whether to enable persistence for the config.
## @param persistence.config.storageClass The storage class to use for the config.
## @param persistence.config.existingClaim The name of an existing claim to use for the config.
## @param persistence.config.accessMode The access mode to use for the config.
## @param persistence.config.size The size to use for the config.
## @param persistence.media.enabled Whether to enable persistence for the media.
## @param persistence.media.storageClass The storage class to use for the media.
## @param persistence.media.existingClaim The name of an existing claim to use for the media.
## @param persistence.media.accessMode The access mode to use for the media.
## @param persistence.media.size The size to use for the media.
## @param persistence.backup.enabled Whether to enable backup persistence.
## @param persistence.backup.storageClass The storage class to use for backup persistence.
## @param persistence.backup.existingClaim The name of an existing claim to use for backup persistence.
## @param persistence.backup.accessMode The access mode to use for backup persistence.
## @param persistence.backup.size The size to use for backup persistence.
## @param persistence.additionalVolumes Additional volumes to add to the pod.
## @param persistence.additionalMounts Additional volume mounts to add to the pod.
##
enabled: true
replicaCount: 1

image:
  repository: ghcr.io/blakeblackshear/frigate
  pullPolicy: IfNotPresent
  tag: "0.14.1"
  autoupdate:
    enabled: false
    strategy: ""
    allowTags: ""
    ignoreTags: []
    pullSecret: ""
    platforms: []

imagePullSecrets: []

deployment:
  strategy:
    type: Recreate

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext:
  privileged: true
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

initContainers: []
  # - name: init-container
  #   image: busybox
  #   command: ['sh', '-c', 'echo "this is an init container"']

service:
  type: LoadBalancer
  port: 5000
  nodePort: ""

ingress:
  enabled: true
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

env:
  TZ: "Europe/London"
  # Database connection will be configured via secrets when database.enabled=true
  # Otherwise, Frigate will use SQLite
  # FRIGATE_DATABASE_URL: "postgresql://user:password@host:5432/frigate"

# Database configuration using CloudNativePG
# Note: Frigate only supports cluster mode (no standalone or external modes)
postgres:
  mode: cluster  # Only cluster mode supported for Frigate
  initSQL: []
    # - "CREATE EXTENSION IF NOT EXISTS pg_trgm;"

  username: frigate
  database: "frigate"

  # Secret configuration for database password
  # You must provide EITHER secretName (to use existing secret) OR value (to create new secret with password)
  password:
    secretName: ""  # Name of existing secret containing the password
    value: ""  # Direct password value (if secretName is empty, this must be provided)

  # CloudNativePG Cluster deployment
  cluster:
    persistence:
      enabled: true
      size: 512Mi
      storageClass: ""

    instances: 1
    image:
      repository: ghcr.io/cloudnative-pg/postgresql
      tag: "16.6"

tmpfs:
  enabled: true
  size: 1Gi

persistence:
  config:
    enabled: true
    storageClass: "ceph-rbd"
    existingClaim: ""
    accessMode: ReadWriteOnce
    size: 512Mi
  media:
    enabled: true
    storageClass: "ceph-rbd"
    existingClaim: ""
    accessMode: ReadWriteOnce
    size: 512Mi
  backup:
    enabled: true
    storageClass: "cephfs"
    existingClaim: ""
    accessMode: ReadWriteMany
    size: 512Mi
  additionalVolumes: []
  additionalMounts: []


## @section ArgoCD Image Updater parameters

## @param imageUpdater.namespace Namespace where the ImageUpdater CRD will be created.
## @param imageUpdater.argocdNamespace Namespace where ArgoCD Applications are located.
## @param imageUpdater.applicationName Name or pattern of the ArgoCD Application to update. Defaults to Release name.
## @param imageUpdater.imageAlias Alias for the image in the ImageUpdater CRD. Defaults to Release name.
## @param imageUpdater.forceUpdate Force update even if image is not currently deployed.
## @param imageUpdater.helm Helm-specific configuration for parameter names (e.g., {name: "image.repository", tag: "image.tag"}).
## @param imageUpdater.kustomize Kustomize-specific configuration (e.g., {name: "original/image"}).
## @param imageUpdater.writeBackConfig Write-back configuration for GitOps.
##
imageUpdater:
  namespace: argocd
  argocdNamespace: argocd
  applicationName: ""
  imageAlias: ""
  forceUpdate: false
  helm: {}
  kustomize: {}
  writeBackConfig: {}
